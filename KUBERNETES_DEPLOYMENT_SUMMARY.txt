â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                            â•‘
â•‘           KUBERNETES DEPLOYMENT - RESUMEN EJECUTIVO                       â•‘
â•‘           Generador de NÃºmeros Primos - Sistema Distribuido              â•‘
â•‘                                                                            â•‘
â•‘           Fecha: 3 de Diciembre de 2025                                  â•‘
â•‘           VersiÃ³n: 1.0 - COMPLETO Y LISTO PARA PRODUCCIÃ“N                â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ESTADO DEL PROYECTO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Kubernetes alineado con init.sql
âœ… Base de datos (PostgreSQL) configurada correctamente
âœ… Cache/Cola (Redis) operativa
âœ… API REST con auto-escalado
âœ… Workers distribuidos con auto-escalado
âœ… GuÃ­as completas de despliegue
âœ… Script de automatizaciÃ³n funcional
âœ… Soporta KillerCoda
âœ… Seguridad implementada (Secrets, Namespaces, SecurityContexts)
âœ… Troubleshooting incluido


COMANDOS RÃPIDOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DESPLIEGUE AUTOMÃTICO (RECOMENDADO):
  $ ./k8s-deploy.sh --auto
  
  Tiempo: 3-5 minutos
  Resultado: AplicaciÃ³n completa corriendo


DESPLIEGUE CON MENÃš INTERACTIVO:
  $ ./k8s-deploy.sh
  
  Opciones:
    1) Despliegue completo automÃ¡tico
    2) Verificar estado actual
    3-8) Ver logs (API, Workers, BD, Cache)
    9) Limpiar todo


ACCEDER A LA APLICACIÃ“N:
  Terminal 1:
  $ kubectl port-forward -n primes svc/primes-api-service 8000:80
  
  Terminal 2:
  $ curl http://localhost:8000/


MONITOREO EN TIEMPO REAL:
  $ kubectl get pods -n primes -w
  $ kubectl logs -n primes -l app=primes-worker -f


LIMPIAR TODO:
  $ kubectl delete namespace primes


ARCHIVOS CREADOS/MODIFICADOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DOCUMENTACIÃ“N (5 ARCHIVOS):
  
  â”œâ”€ K8S_START_HERE.md              â† EMPIEZA AQUÃ (30 segundos)
  â”œâ”€ K8S_INDEX.md                   â† Ãndice de todas las guÃ­as
  â”œâ”€ K8S_DEPLOYMENT_GUIDE.md        â† GuÃ­a completa (500+ lÃ­neas)
  â”œâ”€ KILLERCODA_QUICKSTART.md       â† Para KillerCoda (5 minutos)
  â””â”€ CAMBIOS_KUBERNETES.md          â† Resumen de cambios


SCRIPT DE AUTOMATIZACIÃ“N (1 ARCHIVO):

  â””â”€ k8s-deploy.sh                  â† Despliegue automÃ¡tico (600+ lÃ­neas)


KUBERNETES YAML - MODIFICADOS (5 ARCHIVOS):

  â”œâ”€ init-sql-configmap.yaml        â† Script SQL correcto (01-init.sql)
  â”œâ”€ postgres.yaml                  â† PASSWORD desde Secret
  â”œâ”€ deployment.yaml                â† DATABASE_URL desde Secret
  â”œâ”€ worker-deployment.yaml         â† DATABASE_URL desde Secret
  â””â”€ configmap.yaml                 â† Sin datos sensibles


KUBERNETES YAML - NUEVOS (2 ARCHIVOS):

  â”œâ”€ namespace.yaml                 â† Namespace "primes"
  â””â”€ secrets.yaml                   â† Credenciales seguras


REFERENCIA ACTUALIZADA (1 ARCHIVO):

  â””â”€ k8s/README.md                  â† Referencia rÃ¡pida


ARQUITECTURA DESPLEGADA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NAMESPACE: primes

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ API Deployment                              â”‚
  â”‚ â””â”€ Pods: 2-5 (auto-escalado a 70% CPU)     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”œâ”€â†’ postgresql.primes:5432
                      â”œâ”€â†’ redis.primes:6379
                      â””â”€â†’ LoadBalancer :80

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Workers Deployment                          â”‚
  â”‚ â””â”€ Pods: 3-20 (auto-escalado a 75% CPU)    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”œâ”€â†’ postgresql.primes:5432
                      â””â”€â†’ redis.primes:6379

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ PostgreSQL StatefulSet                      â”‚
  â”‚ â””â”€ Pod: postgres-0                          â”‚
  â”‚    â””â”€ PersistentVolume: 10Gi               â”‚
  â”‚       â””â”€ Tablas: solicitudes, resultados    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Redis StatefulSet                           â”‚
  â”‚ â””â”€ Pod: redis-0                             â”‚
  â”‚    â””â”€ PersistentVolume: 1Gi                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


BASE DE DATOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Nombre: primes
Usuario: primes_user
ContraseÃ±a: primes_pass (en secrets.yaml)

Tablas:
  â”œâ”€ solicitudes
  â”‚  â”œâ”€ id (UUID, PRIMARY KEY)
  â”‚  â”œâ”€ cantidad (INT)
  â”‚  â”œâ”€ digitos (INT)
  â”‚  â”œâ”€ generados (INT)
  â”‚  â””â”€ creado_en (TIMESTAMP)
  â”‚
  â””â”€ resultados
     â”œâ”€ solicitud_id (UUID, FK â†’ solicitudes)
     â”œâ”€ primo (TEXT)
     â””â”€ PRIMARY KEY (solicitud_id, primo)

Ãndices:
  â””â”€ idx_primo_global (UNIQUE en primo)

Extensiones:
  â””â”€ uuid-ossp


VARIABLES DE CONFIGURACIÃ“N
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Variables en ConfigMap (configmap.yaml):
  â”œâ”€ REDIS_HOST: redis.primes.svc.cluster.local
  â”œâ”€ REDIS_PORT: 6379
  â”œâ”€ LOG_LEVEL: info
  â””â”€ APP_ENV: kubernetes

Variables en Secret (secrets.yaml):
  â”œâ”€ DATABASE_URL: postgresql://primes_user:primes_pass@postgres...
  â”œâ”€ postgres.password: primes_pass
  â”œâ”€ postgres.username: primes_user
  â””â”€ postgres.database: primes


PLATAFORMAS SOPORTADAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… KillerCoda              (Recomendado para aprender)
âœ… Minikube                (Local - desarrollo)
âœ… Docker Desktop + K8s    (Local - desarrollo)
âœ… AWS EKS                 (ProducciÃ³n)
âœ… Google GKE              (ProducciÃ³n)
âœ… Azure AKS               (ProducciÃ³n)
âœ… DigitalOcean Kubernetes (Cloud)
âœ… Cualquier cluster Kubernetes 1.20+


REQUISITOS DEL SISTEMA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Kubernetes:
  â””â”€ VersiÃ³n: 1.20 o superior
  â””â”€ Control Plane: Accesible
  â””â”€ Nodos: Al menos 1 disponible

Hardware MÃ­nimo:
  â”œâ”€ CPU: 4 cores
  â”œâ”€ RAM: 4GB
  â”œâ”€ Almacenamiento: 20GB
  â””â”€ Red: Conectividad interna

Software:
  â”œâ”€ kubectl: configurado
  â”œâ”€ Docker: (opcional, solo si construyes imagen)
  â””â”€ curl: (para testing)


SEGURIDAD IMPLEMENTADA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ Namespace aislado (primes)
âœ“ Secrets para credenciales (no hardcoded)
âœ“ SecurityContext en pods (rootless cuando posible)
âœ“ Network Policies (disponibles en network-policy.yaml)
âœ“ Pod Disruption Budget (HA)
âœ“ Probes de salud (liveness y readiness)
âœ“ Resource limits (CPU y memoria)
âœ“ Least privilege principles


ESCALABILIDAD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Horizontal Pod Autoscaler (HPA):
  
  API:
  â”œâ”€ MÃ­nimo: 2 replicas
  â”œâ”€ MÃ¡ximo: 5 replicas
  â””â”€ Trigger: 70% CPU

  Workers:
  â”œâ”€ MÃ­nimo: 3 replicas
  â”œâ”€ MÃ¡ximo: 20 replicas
  â””â”€ Trigger: 75% CPU

Almacenamiento:
  â”œâ”€ PostgreSQL: 10Gi (PersistentVolume)
  â””â”€ Redis: 1Gi (PersistentVolume)


FLUJO DE DESPLIEGUE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Paso 1: Verificaciones previas
  â””â”€ kubectl disponible
  â””â”€ Cluster accesible

Paso 2: Crear infraestructura
  â””â”€ Namespace
  â””â”€ Secrets
  â””â”€ ConfigMaps
  â””â”€ Init SQL ConfigMap

Paso 3: Desplegar servicios persistentes
  â””â”€ PostgreSQL (esperar 30-60s)
  â””â”€ Redis (esperar 20-30s)

Paso 4: Desplegar aplicaciÃ³n
  â””â”€ API (esperar 30-60s)
  â””â”€ Workers (esperar 30-60s)

Paso 5: Exponer servicios
  â””â”€ LoadBalancer
  â””â”€ HPA

Paso 6: Verificar
  â””â”€ Todos los pods corriendo
  â””â”€ Servicios accesibles
  â””â”€ Base de datos inicializada

Tiempo total: 3-5 minutos


TESTING DESPUÃ‰S DEL DESPLIEGUE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Verificar estado:
   $ kubectl get all -n primes
   
   Resultado esperado:
   â”œâ”€ 2 pods primes-api corriendo
   â”œâ”€ 3 pods primes-worker corriendo
   â”œâ”€ 1 pod postgres-0 corriendo
   â””â”€ 1 pod redis-0 corriendo

2. Crear solicitud:
   $ curl -X POST http://localhost:8000/solicitudes \
     -H "Content-Type: application/json" \
     -d '{"cantidad": 5, "digitos": 2}'

3. Verificar en base de datos:
   $ kubectl exec -it postgres-0 -n primes -- psql -U primes_user -d primes \
     -c "SELECT * FROM solicitudes;"

4. Ver workers procesando:
   $ kubectl logs -n primes -l app=primes-worker -f


TROUBLESHOOTING RÃPIDO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Problema: Pod en CrashLoopBackOff
  â””â”€ Ver logs: kubectl logs -n primes <pod-name>
  â””â”€ Describir: kubectl describe pod -n primes <pod-name>

Problema: Pod en Pending
  â””â”€ Verificar recursos: kubectl describe nodes
  â””â”€ Verificar PVC: kubectl get pvc -n primes

Problema: PostgreSQL no inicializa
  â””â”€ Ver logs: kubectl logs -n primes postgres-0
  â””â”€ Verificar init script: kubectl exec -it postgres-0 -n primes -- ls -la \
     /docker-entrypoint-initdb.d/

Problema: No hay conectividad entre servicios
  â””â”€ Test DNS: kubectl exec -it <pod> -n primes -- nslookup postgres.primes
  â””â”€ Test conexiÃ³n: kubectl exec -it <pod> -n primes -- psql -h postgres ...

Ver mÃ¡s: K8S_DEPLOYMENT_GUIDE.md (SecciÃ³n Troubleshooting)


DOCUMENTACIÃ“N DISPONIBLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Para usuario rÃ¡pido (5 minutos):
  â””â”€ K8S_START_HERE.md                 â† Empieza por aquÃ­
  â””â”€ KILLERCODA_QUICKSTART.md          â† Si usas KillerCoda

Para aprendizaje completo (30-60 minutos):
  â””â”€ K8S_DEPLOYMENT_GUIDE.md           â† GuÃ­a detallada con todo
  â””â”€ k8s/README.md                     â† Referencia de archivos

Para desarrolladores:
  â””â”€ CAMBIOS_KUBERNETES.md             â† QuÃ© cambiÃ³ y por quÃ©
  â””â”€ K8S_INDEX.md                      â† Ãndice completo de documentaciÃ³n


PRÃ“XIMOS PASOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Lee: K8S_START_HERE.md (30 segundos)

2. Ejecuta: ./k8s-deploy.sh --auto (3-5 minutos)

3. Accede:
   Terminal 1: kubectl port-forward -n primes svc/primes-api-service 8000:80
   Terminal 2: curl http://localhost:8000/

4. Experimenta:
   - Crea solicitudes
   - Observa workers procesando
   - Escala manualmente
   - Ve los datos en BD

5. Aprende:
   - Si necesitas detalle, lee K8S_DEPLOYMENT_GUIDE.md


CONTACTO Y SOPORTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DocumentaciÃ³n: Ver archivos .md en el proyecto
Troubleshooting: K8S_DEPLOYMENT_GUIDE.md (SecciÃ³n Troubleshooting)
Scripts: k8s-deploy.sh --help (en el script interactivo)


FIN DEL RESUMEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Estado: âœ… LISTO PARA PRODUCCIÃ“N
AlineaciÃ³n: âœ… COMPLETA CON init.sql
DocumentaciÃ³n: âœ… COMPLETA Y DETALLADA
AutomatizaciÃ³n: âœ… FUNCIONAL
Testing: âœ… INCLUIDO

Â¡Listo para desplegar! ğŸš€

Para comenzar ahora mismo:
  $ ./k8s-deploy.sh --auto

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
